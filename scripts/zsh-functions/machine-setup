# Machine setup utilities for dotfiles management

# =============================================================================
# LEAVING MACHINE FUNCTIONS
# =============================================================================

leave-machine() {
    echo "üöÄ Leaving machine - capturing all package lists..."
    
    # Ensure we're in dotfiles directory
    cd "$HOME/dotfiles" || {
        echo "‚ùå Error: Not in dotfiles directory"
        return 1
    }
    
    # Capture all package lists
    leave-brew
    echo "üîç Brewfile captured"
    leave-cursor
    echo "üîç Cursor extensions captured"

    # Git operations if -c flag is passed
    if [[ "$*" == *"-c"* ]]; then
        echo "üìù Committing changes..."
        git add .
        git commit -m "Leaving machine - $(date '+%Y-%m-%d %H:%M:%S')"
        git push origin main
    fi
    
    echo "‚úÖ Successfully left machine!"
}

# =============================================================================
# FRESH MACHINE SETUP FUNCTIONS
# =============================================================================

setup-fresh-machine() {
    echo "üñ•Ô∏è  Setting up fresh machine..."
    
    # Ensure we're in dotfiles directory
    cd "$HOME/dotfiles" || {
        echo "‚ùå Error: Not in dotfiles directory"
        return 1
    }
    
    # Call the standalone script
    ./scripts/setup-new-machine --skip-prerequisites --skip-clone
}
